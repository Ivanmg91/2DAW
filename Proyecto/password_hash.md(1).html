<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>password_hash.md</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2 id="función-password_hash-hashing-de-contraseñas">1. Función <code>password_hash()</code>: Hashing de Contraseñas</h2>
<p>La función <code>password_hash()</code> de PHP es la forma <strong>estándar y recomendada</strong> de almacenar contraseñas de forma segura en una base de datos. Su uso es vital para proteger las <strong>credenciales secretas</strong> del usuario.</p>
<h3 id="¿qué-es-el-hashing">¿Qué es el Hashing?</h3>
<p>El hashing es un proceso de transformación de una cadena de texto (la contraseña) en otra cadena de longitud fija, llamada <em>hash</em> o resumen.</p>
<ol>
<li>
<p><strong>Es Irreversible (Unidireccional):</strong> A diferencia del cifrado (encryption), el hashing es un proceso de “una sola vía”. No existe una función que convierta el hash de vuelta a la contraseña original.</p>
</li>
<li>
<p><strong>No es para Almacenar:</strong> El hash no se utiliza para almacenar o recuperar datos sensibles, sino para <strong>verificar</strong> que el usuario conoce la contraseña.</p>
</li>
<li>
<p><strong>Uso de <em>Salt</em>:</strong> <code>password_hash()</code> automáticamente utiliza un valor aleatorio (llamado <em>salt</em> o sal) para generar el hash. Esto garantiza que dos usuarios con la misma contraseña tendrán hashes completamente diferentes. Esto protege contra los ataques de “tablas arcoíris” (<em>rainbow tables</em>).</p>
</li>
<li>
<p><strong>Lentitud Intencional:</strong> La función está diseñada para ser <strong>computacionalmente lenta</strong> (gracias al algoritmo <strong>Bcrypt</strong> o <strong>Argon2</strong>), lo que hace extremadamente costoso y pesado para un atacante probar millones de contraseñas por segundo (<em>brute force</em>).</p>
</li>
</ol>
<h3 id="¿cómo-funciona-la-autenticación">¿Cómo Funciona la Autenticación?</h3>
<p>Cuando un usuario intenta iniciar sesión:</p>
<ul>
<li>
<p>El servidor <strong>no</strong> descifra el hash almacenado.</p>
</li>
<li>
<p>En su lugar, utiliza la función <code>password_verify()</code> para aplicar el mismo algoritmo de hashing (incluyendo el <em>salt</em> que está incrustado en el hash almacenado) a la contraseña introducida por el usuario.</p>
</li>
<li>
<p>Si el hash recién generado coincide con el hash almacenado, la contraseña es correcta y la <strong>autenticación</strong> es exitosa.</p>
</li>
</ul>
<h2 id="ejemplo">Ejemplo</h2>
<pre class=" language-php"><code class="prism  language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// --- Parte 1: Simulación de Registro / Almacenamiento de Contraseña ---</span>
<span class="token keyword">echo</span> <span class="token string">"## 📝 Paso 1: Generar y Almacenar el Hash\n"</span><span class="token punctuation">;</span>

<span class="token comment">// 1. La contraseña que el usuario introduce al registrarse.</span>
<span class="token variable">$contrasena_texto_plano</span> <span class="token operator">=</span> <span class="token string">"MiContrasenaSuperSegura123"</span><span class="token punctuation">;</span>

<span class="token comment">// 2. Usamos password_hash() para cifrar la contraseña.</span>
<span class="token comment">//    PASSWORD_DEFAULT selecciona el mejor algoritmo disponible (actualmente Argon2i o Bcrypt).</span>
<span class="token comment">//    ¡El hash generado es la única cosa que deberías almacenar en tu base de datos!</span>
<span class="token variable">$hash_almacenado</span> <span class="token operator">=</span> <span class="token function">password_hash</span><span class="token punctuation">(</span><span class="token variable">$contrasena_texto_plano</span><span class="token punctuation">,</span> <span class="token constant">PASSWORD_DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string">"Contraseña de Texto Plano: "</span> <span class="token punctuation">.</span> <span class="token variable">$contrasena_texto_plano</span> <span class="token punctuation">.</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">"Hash Generado y Almacenado: "</span> <span class="token punctuation">.</span> <span class="token variable">$hash_almacenado</span> <span class="token punctuation">.</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">"--- \n"</span><span class="token punctuation">;</span>


<span class="token comment">// --- Parte 2: Simulación de Inicio de Sesión / Verificación de Contraseña ---</span>
<span class="token keyword">echo</span> <span class="token string">"## 🔍 Paso 2: Verificar la Contraseña al Iniciar Sesión\n"</span><span class="token punctuation">;</span>

<span class="token comment">// 3. Contraseña introducida por el usuario al iniciar sesión (EXITOSA).</span>
<span class="token variable">$intento_exitoso</span> <span class="token operator">=</span> <span class="token string">"MiContrasenaSuperSegura123"</span><span class="token punctuation">;</span>

<span class="token comment">// 4. Usamos password_verify() para comparar el intento con el hash almacenado.</span>
<span class="token comment">//    Nunca se descifra el hash; en su lugar, se hashea el intento con la misma</span>
<span class="token comment">//    información contenida en el hash y se comparan los resultados.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">password_verify</span><span class="token punctuation">(</span><span class="token variable">$intento_exitoso</span><span class="token punctuation">,</span> <span class="token variable">$hash_almacenado</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">"Intento 1 (Éxito): '"</span> <span class="token punctuation">.</span> <span class="token variable">$intento_exitoso</span> <span class="token punctuation">.</span> <span class="token string">"'\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string">"**¡Verificación EXITOSA!** El usuario puede iniciar sesión.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">"**¡Verificación FALLIDA!** Contraseña incorrecta.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">echo</span> <span class="token string">"--- \n"</span><span class="token punctuation">;</span>

<span class="token comment">// 5. Contraseña introducida por el usuario al iniciar sesión (FALLIDA).</span>
<span class="token variable">$intento_fallido</span> <span class="token operator">=</span> <span class="token string">"ContrasenaIncorrecta456"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">password_verify</span><span class="token punctuation">(</span><span class="token variable">$intento_fallido</span><span class="token punctuation">,</span> <span class="token variable">$hash_almacenado</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">"**¡Verificación EXITOSA!** El usuario puede iniciar sesión.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">"Intento 2 (Fallo): '"</span> <span class="token punctuation">.</span> <span class="token variable">$intento_fallido</span> <span class="token punctuation">.</span> <span class="token string">"'\n"</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string">"**¡Verificación FALLIDA!** Contraseña incorrecta.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre>
<h3 id="explicación-de-las-funciones">Explicación de las Funciones</h3>
<ul>
<li>
<p><strong><code>password_hash($password, $algo, $options)</code></strong>:</p>
<ul>
<li>
<p><strong>¿Qué hace?</strong> Toma la contraseña de texto plano y genera un <strong>hash criptográfico seguro</strong>.</p>
</li>
<li>
<p><strong>Importante:</strong> El <em>hash</em> generado no es reversible (no puedes obtener la contraseña original a partir de él), y cada vez que llamas a <code>password_hash()</code> produce un resultado <strong>diferente</strong> para la misma contraseña (debido a que internamente usa un <em>salt</em> o valor aleatorio), lo que lo hace muy seguro.</p>
</li>
</ul>
</li>
<li>
<p><strong><code>password_verify($password, $hash)</code></strong>:</p>
<ul>
<li>
<p><strong>¿Qué hace?</strong> Compara una contraseña de texto plano (la que introduce el usuario al iniciar sesión) con un <em>hash</em> previamente generado y almacenado.</p>
</li>
<li>
<p><strong>Resultado:</strong> Devuelve <code>true</code> si la contraseña coincide con el <em>hash</em>, y <code>false</code> en caso contrario. <strong>Es la única forma segura de verificar contraseñas hasheadas.</strong></p>
</li>
</ul>
</li>
</ul>
</div>
</body>

</html>
